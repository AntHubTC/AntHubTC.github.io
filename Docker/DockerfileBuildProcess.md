## Dockerfile构建过程

- 从基础镜像运行一个容器
- 执行一条指令，对容器做出修改
- 执行类似docker commit的操作，提交一个新的中间层镜像
- 再基于刚提交的镜像运行一个新容器
- 执行Dockerfile中的下一条指令，直至所有指令执行完毕



```bash
docker build -t="tc1096648786/webNginx"
# 从返回的结果可以看出一些dockerfile的构建过程中每一步执行的情况。
从返回中可以看到

中间层镜像不会被删除，中间层容器会被删除

可以使用中间层镜像调试。 我们可以使用docker run命令通过中间层镜像运行一个容器，从而查看每一步构建镜像的实际状态，这也是给了我们调试镜像构建的能力。
```

**使用中间层镜像进行调试**

- 查找错误

- 构建缓存

  ​	构建过程中有使用using cache的字样。

- 不使用缓存

  ​	docker build --no-cache  # 不使用缓存

  ​	或者

  ```
  更改 ENV REFRESH_DATE 2019-09-13的日期，这个时候你就会发现在这个命令之前还是使用了缓存，这个命令之后的命令就没有再使用缓存。
  ```

- 查看镜像构建的过程

  docker history [image]