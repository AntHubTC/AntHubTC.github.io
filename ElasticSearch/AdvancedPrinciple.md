# 进阶原理

## 解析ES的分布式架构

### 分布式架构的透明隐藏特性

Elasticsearch是一个分布式系统,隐藏了复杂的处理机制。

1. 分片机制： 我们不用关心数据是按照什么机制分片的，最后放入到哪个分片中。
2. 分片的副本：
3. 集群发现机制（cluster discovery）：比如当前我们启动了一个es进程， 当启动了第二个es进程时，这个进程作为一个node自动就发现了集群，并且加入了进去。
4. shard负载均衡：比如现在有10shard，集群中有3个节点，es会进行负载均衡的进行分配，以保持每个节点均衡的负载请求。
5. 请求路由

### 扩容机制

垂直扩容：购置新的机器，替换已有的机器

水平扩容：直接添加机器

### 自动均衡rebalance

增加或减少节点时会自动均衡

### master节点

​	master节点是通过选举产生的， 它的主要职责是和集群操作相关的内容,如创建或删除索引,跟踪哪些节点是集集的一部分,并决定啷些分片分配相关的节点。稳定的主节点对集群的健康是非常重要的。

### 节点对等

​	**每个节点都能接收**请求毎个节点接收到请求后都能把该请求路由到有相关数据的其它节点上接收原始请求的节点负责采集数据并返回给客户端

## 分片和副本机制

