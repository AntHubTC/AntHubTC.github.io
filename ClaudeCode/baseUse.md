# 基本操作



## 记忆

### /int

👉 *“为这个项目建立一份长期有效的 AI 项目说明书（世界观 +规则）”*

用来**初始化项目级记忆**，让 Claude Code 在整个项目中都“记住”：

- 你在做什么项目
- 技术栈
- 代码风格
- 约定
- 不要犯的错
- 偏好（比如简洁、偏底层、少废话）

这些内容会被写入 **Claude 的长期上下文**，不是一轮对话就没了。



**什么时候用？**

- ✅ 新项目开始
- ✅ 换技术栈
- ✅ Claude 老是给你不想要的答案
- ❌ 不要每次都用（会污染记忆）



### /memory

👉 *“在项目进行过程中，动态追加或修改 AI 的长期记忆 「项目持续记忆补丁”*

#### 常见使用场景

1️⃣ 修正 Claude 的行为

```
/memory
在这个项目中，不要使用第三方地图库。
```

以后你再问地图相关问题，它就不会乱推荐了。

------

2️⃣ 记录重要决策

```
/memory
该项目最终决定使用 RTK + UWB 进行定位，不考虑 GPS。
```

之后再问定位方案，Claude 会基于这个前提回答。

------

3️⃣ 固化你的偏好（非常好用）

```
/memory
用户更喜欢直接给结论和工程实现，不要写科普解释。
```

这会明显提升**长期对话质量**。

------

4️⃣ 项目背景事实

```
/memory
该系统部署在无公网的内网环境。
```

Claude 后面就不会再建议云服务了。



### /init  vs  /memory 对比表

| 对比项     | `/init`  | `/memory`  |
| ---------- | -------- | ---------- |
| 使用频率   | 低       | 高         |
| 时机       | 项目开始 | 项目进行中 |
| 内容       | 全局设定 | 增量事实   |
| 是否可多次 | 不建议   | 非常适合   |
| 类比       | README   | 会议纪要   |



### 实战示例（完整流程）

**第一步：初始化**

```markdown
/init
项目：真实场景中坦克定位系统
目标：厘米级定位

技术：
- 语言：C++
- 硬件：UWB + IMU
- 环境：室外复杂地形

约定：
- 不考虑视觉方案
- 不用深度学习
- 偏工程落地
```

------

**第二步：中途更新记忆**

```markdown
/memory
坦克运行时会剧烈震动，IMU 漂移严重。
/memory
预算有限，不能使用工业级光纤陀螺。
```

👉 后续 Claude 的算法、滤波、传感器融合方案都会自动考虑这些限制。


### 高手用法（进阶）

**✔ 把 Claude 调成「你的项目合伙人」**

你可以写这种：

```markdown
/memory
在该项目中，你的角色是系统架构师而非教学助手。
```

效果非常明显。

**❌ 不推荐的做法**

- 把情绪、一次性吐槽写进 `/memory`
- 用 `/init` 写几十页
- 频繁 reset /init



## 运行模式

### 总览

| 模式          | 核心作用     | 是否改代码  | 风险等级 |
| ------------- | ------------ | ----------- | -------- |
| **Plan Mode** | 想清楚再动手 | ❌           | 🟢 低     |
| **Edit Mode** | 可控修改代码 | ✅（需确认） | 🟡 中     |
| **YOLO Mode** | 全自动执行   | ✅（不确认） | 🔴 极高   |

一句话理解：

> **Plan：只动脑**
> **Edit：动手前问你**
> **YOLO：我直接干了**

------

### Plan Mode（计划模式）

1️⃣ 触发方式

```bash
claude
# 或在会话中
/plan
```

（具体指令名可能随版本变化，但语义一致）

------

2️⃣ 模式行为特征

- **绝不改代码**
- 不执行 shell
- 不创建 / 删除文件
- 只做：
  - 架构分析
  - 修改方案
  - 风险评估
  - 执行步骤拆解

👉 输出通常是：

```
计划
├─ 目标
├─ 影响文件
├─ 修改点
├─ 风险
└─ 下一步建议
```

------

3️⃣ 什么时候用 Plan Mode？

✅ 非常适合：

- 大规模重构前
- 新 feature 设计
- 接手陌生代码库
- 你还没想好“要不要这么干”

❌ 不适合：

- 小改动
- 紧急修 bug

------

4️⃣ 专业建议

> **强制养成习惯：大改动 = 先 Plan**

很多线上事故，本质是跳过了这一步。

------

### Edit Mode（编辑模式）

1️⃣ 触发方式

```bash
claude edit
```

或在会话中同意修改建议。

------

2️⃣ 模式行为特征

- 可以：
  - 修改文件
  - 新建文件
- **每一步都需要你确认**
- 修改前会说明：
  - 改哪些文件
  - 为什么改
  - 怎么改

👉 本质是：

> **“人类在回路中（Human-in-the-loop）”**

------

3️⃣ Edit Mode 的真实执行流程

```
① Claude 分析任务
② 提出修改方案
③ 等你 yes / no
④ 执行修改
⑤ 展示 diff
```

------

4️⃣ 什么时候用 Edit Mode？

✅ 日常开发 80% 场景：

- 加接口
- 改逻辑
- 调参数
- 重构局部代码

❌ 不适合：

- 非常碎的微改（你自己更快）
- 高风险自动化任务

------

### YOLO Mode（危险模式）

1️⃣ 触发方式

```bash
claude --dangerously-skip-permissions
```

名字已经写得很明白了 😅

------

2️⃣ 模式行为特征（非常重要）

- ❌ **不再询问你**
- ❌ **不再确认文件修改**
- ❌ **不再确认 shell 执行**
- 可以：
  - 批量改文件
  - 删除文件
  - 执行命令
  - 重构整个项目

👉 Claude 在这个模式下：

> **拥有近似“你本人”的操作权限**

------

3️⃣ 什么时候 *真的* 该用 YOLO？

⚠️ 只推荐这几种：

- 一次性代码生成（新仓库）
- 严格可回滚环境
  - git clean
  - disposable repo
- 你已经：
  - 有完整 Plan
  - 有 clean git 状态

------

4️⃣ 绝对不要在这些场景用

❌ 正在跑生产服务
❌ 有未提交代码
❌ 权限环境混乱
❌ 心情不好时（真不是玩笑）

------

### 三种模式的组合打法（高手用法）

✔ 标准安全流

```
Plan Mode
   ↓
Edit Mode
   ↓
(可选) YOLO Mode
```

------

✔ 高效但可控流（推荐）

```bash
git status clean
claude /plan
claude edit
```

------

✔ YOLO 前的最低安全保障

```bash
git add .
git commit -m "checkpoint before yolo"
claude --dangerously-skip-permissions
```

------

### 核心差异的本质

| 维度     | Plan        | Edit     | YOLO       |
| -------- | ----------- | -------- | ---------- |
| 决策权   | 人          | 人       | AI         |
| 执行权   | 无          | 半自动   | 全自动     |
| 可控性   | 100%        | 高       | 极低       |
| 适合人群 | 架构/负责人 | 日常开发 | 非生产实验 |

------

### 一句话总结（记这个）

> **Plan 是脑，Edit 是手，YOLO 是电锯，用对了很爽，用错了会见血 🩸** 



## 常用命令

### 启动 & 会话控制命令（CLI）

| 命令                                         | 别名 / 说明     | 核心作用           | 典型场景    |
| ------------------------------------------ | ----------- | -------------- | ------- |
| `claude`                                   | 默认启动        | 启动新会话（Edit 模式） | 日常开发    |
| `claude -c`                                | continue    | 继续最近一次对话       | 中断后接着干  |
| `claude -r <id>`                           | 同 `/resume` | 通过会话 ID 恢复会话   | 切终端/跨时间 |
| `claude -p`                                | 无头模式        | 不进入交互式对话       | 脚本 / CI |
| `claude --dangerously-skip-permissions`    | YOLO        | 跳过所有确认         | 一次性自动化  |
| `claude --dangerously-skip-permissions -c` | 复合          | YOLO + 继续最近会话  | 高危快速执行  |


### 运行模式 / 工作流命令（会话内）

| 命令      | 模式        | 是否改代码  | 用途       |
| ------- | --------- | ------ | -------- |
| `/plan` | Plan Mode | ❌      | 设计 / 重构前 |
| `edit`  | Edit Mode | ✅（需确认） | 日常修改     |
| YOLO    | YOLO Mode | ✅（不确认） | 全自动执行    |

> 说明：YOLO 模式由 CLI 参数触发，不是会话命令

### 项目规则 & 长期记忆

| 命令        | 作用级别 | 核心作用          | 备注    |
| --------- | ---- | ------------- | ----- |
| `/init`   | 最高   | 初始化项目规则 / 世界观 | 极少改   |
| `/memory` | 高    | 写入长期事实 / 决策   | 高频高价值 |


### 上下文管理（对话控制）

| 命令       | 影响范围 | 核心作用                                                     | 建议使用时机 |
| ---------- | -------- | ------------------------------------------------------------ | ------------ |
| `/clear`   | 当前对话 | 清空上下文                                                   | 明显跑偏     |
| `/compact` | 当前对话 | 压缩上下文（保重点）                                         | 长对话       |
| `/rewind`  | 当前对话 | 回退到之前状态（回到上一步提问的状态，Claude 会“忘记”刚才那一轮思路，类似ctrl+z，可以多次回退） | 思路带歪     |

#### /rewind

**/rewind不会影响什么（很重要）**

| 不影响项  | 说明             |
| --------- | ---------------- |
| `/memory` | 长期记忆不会回滚 |
| `/init`   | 项目规则不会变   |
| 文件系统  | 已改的文件不撤   |
| git 状态  | 不回滚提交       |
| CLI 会话  | 不等于 `-r`      |

👉 **它只回滚“思考轨迹”，不回滚“现实世界”**

**什么时候该用 `/rewind`？**

✅ 非常适合：

- 刚刚一轮回答把方向带歪
- Claude 误解了你的意图
- 想换一种问法但**不想污染上下文**

❌ 不适合：

- 已经写入 `/memory`
- 已经改了一堆文件
- 想回到“几小时前的会话”



### 文件 & 修改控制

| 命令                  | 功能   | 说明        |
| ------------------- | ---- | --------- |
| `/open <file>`      | 读文件  | 让 CC 理解文件 |
| `/search <keyword>` | 搜索   | 项目内语义搜索   |
| `/diff`             | 查看修改 | 最近变更      |
| `/undo`             | 撤销修改 | 回滚最近编辑    |



