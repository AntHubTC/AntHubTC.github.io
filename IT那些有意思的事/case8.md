# 洗数据:如果多条主体的重复关系只保留一条

```sql
-- 删除重复关系
DELETE FROM `common-crm`.resource_taboo
WHERE id NOT IN (
    SELECT id FROM (
        SELECT MIN(id) AS id -- 每组关系中只保留最小的那条
        FROM `common-crm`.resource_taboo
        WHERE code IN ('00008','04009','20007','16003','16010','16011','16014','21003','07001','13003','01001','03001','08001','08004','09009','11001','16001','21002','07007','13002','22001')
        GROUP BY project_id, code
    ) AS temp
) and code IN ( '00008','04009','20007','16003','16010','16011','16014','21003','07001','13003','01001','03001','08001','08004','09009','11001','16001','21002','07007','13002','22001');

DELETE FROM `common-crm`.scheme_industry
WHERE id NOT IN (
    SELECT id FROM (
        SELECT MIN(id) AS id -- 每组关系中只保留最小的那条
        FROM `common-crm`.scheme_industry
        WHERE industry_code IN ('00008','04009','20007','16003','16010','16011','16014','21003','07001','13003','01001','03001','08001','08004','09009','11001','16001','21002','07007','13002','22001')
        GROUP BY scheme_id, industry_code
    ) AS temp
) and industry_code IN ( -- 作用范围再这部分清洗的行业编码 '00008','04009','20007','16003','16010','16011','16014','21003','07001','13003','01001','03001','08001','08004','09009','11001','16001','21002','07007','13002','22001');
```

