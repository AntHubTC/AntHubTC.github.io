# 故障-二级缓存导致数据不准确问题

## 问题现象：

​	ETL先从三方数据抽取过来的数据，然后数据仓库平台最后的分析数据有时候有错误，和预期值对不上！

## 问题原因：

​	ETL取过来的参数表的变化对于mybatis的二级缓存是不知道的。mybatis开启了二级缓存，二级缓存是namespace级别的，数据分析的时候去取了一张参数表，后续分析都从参数表中拿了参数然后进行数据的计算。mybatis在执行insert、update、delete的时候会清除缓存，或者是主动使用clearCache方法，但ETL对参数表的变动对于mybatis是不知道的。

## 解决办法：

1. 关闭掉二级缓存
2. 做一个接口clearCache让ETL工具去调用一下。
3. 缓存失效策略。 比如失效时间设置端一点。   （感觉这个不能完全保证）

